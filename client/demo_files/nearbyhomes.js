define(["backbonestore","text!templates/listings/results-list-small-item.html","app/models/search","templateEngine","app/ui-modules/images/imageloader"],function(e,t,n,r,i){var s={},o={},u=Hogan.compile(t),a="";return s.PropertyList=e.View.extend({el:$(".js-nearbyhomes"),settings:{},name:"js-listing-nearbyhomes",initialize:function(e){_.extend(this.settings,e),_.bindAll(this,"render","query"),this.settings.el=this.el,e.search=="latlong"?this.query1(e.model.Lat,e.model.Long):(this.settings.model.on("change",this.query),this.query(e.model))},query:function(e){var t=e.get("ListingID"),r=Number(e.get("Latitude")),i=Number(e.get("Longitude")),s=e.get("Price"),o=new n.Listings;r!=0&&i!=0&&!isNaN(r)&&!isNaN(i)?(o.params.lat=r,o.params.long=i,o.params.distance=20,o.params.spatialcomp=1,o.params.sortorder="Proximity",o.params.Count=4,o.params.ExcludeListingID=t,o.params.ksc=!0,o.fetch({success:this.render})):$("#js-nearbyhomes").children().remove()},query1:function(e,t){var r=new n.Listings;e!=0&&t!=0&&!isNaN(e)&&!isNaN(t)&&(r.params.lat=e,r.params.long=t,r.params.distance=30,r.params.spatialcomp=1,r.params.sortorder="Proximity",r.params.Count=8,r.params.sh=!1,r.params.showcase=!0,r.params.ksc=!0,a="homevalues",r.fetch({success:this.render}))},render:function(e,t){var n="";$("#js-nearbyhomes").children().remove(),_.each(t[0],function(e){e.page=!0,a=="homevalues"&&(e.homevalues=!0),n+=u.render(e)}),$("#js-nearbyhomes").append(n),i.GetThumbnails("#js-nearbyhomes"),HMSEvent.trigger("ui-prepare-detaillink")}}),s.RecentSalesList=e.View.extend({el:$(".js-nearbyhomes"),settings:{},name:"js-listing-nearbyhomes",initialize:function(e){_.extend(this.settings,e),_.bindAll(this,"render","query"),this.settings.el=this.el,e.search=="latlong"?this.query1(e.model.Lat,e.model.Long):(this.settings.model.on("change",this.query),this.query(e.model))},query:function(e){var t=e.get("ListingID"),r=Number(e.get("Latitude")),i=Number(e.get("Longitude")),s=e.get("Price"),o=new n.RecentSales;HMSEvent.trigger("ui-show-blocker",{element:"#js-nearbyhomes",cursor:"default",overlay:{opacity:0}}),r!=0&&i!=0&&!isNaN(r)&&!isNaN(i)?(o.params.recentsalesnearbylat=r,o.params.recentsalesnearbylong=i,o.params.distance=20,o.params.spatialcomp=1,o.params.sortorder="Proximity",o.params.Count=4,o.params.ExcludeListingID=t,o.params.ksc=!0,o.fetch({success:this.render})):$("#js-nearbyhomes").children().remove()},query1:function(e,t){var r=new n.RecentSales;HMSEvent.trigger("ui-show-blocker",{element:"#js-nearbyhomes",cursor:"default",overlay:{opacity:0}}),e!=0&&t!=0&&!isNaN(e)&&!isNaN(t)&&(r.params.recentsalesnearbylat=e,r.params.recentsalesnearbylong=t,r.params.distance=30,r.params.spatialcomp=1,r.params.sortorder="Proximity",r.params.Count=8,r.params.sh=!1,r.params.showcase=!0,r.params.ksc=!0,a="recentsales",r.fetch({success:this.render}))},render:function(e,t){var n="";$("#js-nearbyhomes").children().remove(),_.each(t[1],function(e){e.page=!0,e.recentsales=!0,e.Lat=e.Latitude,e.Lng=e.Longitude,n+=u.render(e)}),HMSEvent.trigger("ui-hide-blocker",{element:"#js-nearbyhomes"}),$("#js-nearbyhomes").append(n),i.LazyLoad({selector:"#js-nearbyhomes"}),HMSEvent.trigger("ui-prepare-detaillink")}}),o=s,o})
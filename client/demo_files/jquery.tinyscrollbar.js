(function(e){function t(t,n){function m(){return r.update(),y(),r}function g(){f.obj.css(c,p/u.ratio),o.obj.css(c,-p),v.start=f.obj.offset()[c];var e=h.toLowerCase();u.obj.css(e,a[n.axis]),a.obj.css(e,a[n.axis]),f.obj.css(e,f[n.axis])}function y(){f.obj.bind("mousedown",b),f.obj[0].ontouchstart=function(e){return e.preventDefault(),f.obj.unbind("mousedown"),b(e.touches[0]),!1},a.obj.bind("mouseup",S),n.scroll&&this.addEventListener?(i[0].addEventListener("DOMMouseScroll",w,!1),i[0].addEventListener("mousewheel",w,!1)):n.scroll&&(i[0].onmousewheel=w)}function b(t){v.start=l?t.pageX:t.pageY;var n=parseInt(f.obj.css(c));return d.start=n=="auto"?0:n,e(document).bind("mousemove",S),document.ontouchmove=function(t){e(document).unbind("mousemove"),S(t.touches[0])},e(document).bind("mouseup",E),f.obj.bind("mouseup",E),f.obj[0].ontouchend=document.ontouchend=function(t){e(document).unbind("mouseup"),f.obj.unbind("mouseup"),E(t.touches[0])},!1}function w(t){if(!(o.ratio>=1)){t=e.event.fix(t||window.event);var r=t.wheelDelta?t.wheelDelta/120:-t.detail/3;p-=r*n.wheel,p=Math.min(o[n.axis]-s[n.axis],Math.max(0,p)),f.obj.css(c,p/u.ratio),o.obj.css(c,-p),t.preventDefault()}}function E(t){return e(document).unbind("mousemove",S),e(document).unbind("mouseup",E),f.obj.unbind("mouseup",E),document.ontouchmove=f.obj[0].ontouchend=document.ontouchend=null,!1}function S(e){return o.ratio>=1||(d.now=Math.min(a[n.axis]-f[n.axis],Math.max(0,d.start+((l?e.pageX:e.pageY)-v.start))),p=d.now*u.ratio,o.obj.css(c,-p),f.obj.css(c,d.now)),!1}var r=this,i=t,s={obj:e(".viewport",t)},o={obj:e(".overview",t)},u={obj:e(".scrollbar",t)},a={obj:e(".track",u.obj)},f={obj:e(".thumb",u.obj)},l=n.axis=="x",c=l?"left":"top",h=l?"Width":"Height",p,d={start:0,now:0},v={};return this.update=function(e){s[n.axis]=s.obj[0]["offset"+h],o[n.axis]=o.obj[0]["scroll"+h],o.ratio=s[n.axis]/o[n.axis],u.obj.toggleClass("disable",o.ratio>=1),a[n.axis]=n.size=="auto"?s[n.axis]:n.size,f[n.axis]=Math.min(a[n.axis],Math.max(0,n.sizethumb=="auto"?a[n.axis]*o.ratio:n.sizethumb)),u.ratio=n.sizethumb=="auto"?o[n.axis]/a[n.axis]:(o[n.axis]-s[n.axis])/(a[n.axis]-f[n.axis]),p=e=="relative"&&o.ratio<=1?Math.min(o[n.axis]-s[n.axis],Math.max(0,p)):0,p=e=="bottom"&&o.ratio<=1?o[n.axis]-s[n.axis]:isNaN(parseInt(e))?p:parseInt(e),g()},m()}e.tiny=e.tiny||{},e.tiny.scrollbar={options:{axis:"y",wheel:40,scroll:!0,size:"auto",sizethumb:"auto"}},e.fn.tinyscrollbar=function(n){var n=e.extend({},e.tiny.scrollbar.options,n);return this.each(function(){e(this).data("tsb",new t(e(this),n))}),this},e.fn.tinyscrollbar_update=function(t){return e(this).data("tsb").update(t)}})(jQuery)
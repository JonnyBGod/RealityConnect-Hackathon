function formatCurrency(e,t){e=e.toString().replace(/\$|\,/g,""),isNaN(e)&&(e="0"),sign=e==(e=Math.abs(e)),e=Math.floor(e*100+.50000000001),t&&(cents=e%100),e=Math.floor(e/100).toString(),t&&cents<10&&(cents="0"+cents);for(var n=0;n<Math.floor((e.length-(1+n))/3);n++)return e=e.substring(0,e.length-(4*n+3))+","+e.substring(e.length-(4*n+3)),t?(sign?"":"-")+"$"+e+"."+cents:(sign?"":"-")+"$"+e}$.fn.getDataAttrs=function(e){var t=$(this).get(0),n={};for(var r=0,i=t.attributes,s=i.length;r<s;r++){var o=i.item(r).nodeName,u=i.item(r).nodeValue;if(o.match(/data/)!=null){var a=o.split("-"),f=a[1];e==1&&$(".ui-dialog-content").attr(o,u);if(u!=null&&u.match(/\}/)!=null){var l=$.parseJSON(u);n[f]=l}else n[f]=u}}return n},$.fn.compareSelected=function(e){$(this).click(function(){var e=$(this).parents("section").find('input[type="checkbox"]');if(e.length>0){var t={},n=0;e.each(function(e){if($(this).attr("checked")){var n=$(this).parents("article");t.listings=[],t.listings[e]={},t.listings[e].streetaddress=n.find(".street-address").html(),t.listings[e].postalcode=n.find(".postal-code").html(),t.listings[e].price=n.find(".price").html(),t.listings[e].image=n.find(".col-a .thumb").html()}}),EJS.config({cache:!1});var r=(new EJS({url:"/resources/jstemplates/selectedForComparison.ejs"})).render({data:listings});$(".module_selected").length>0&&$(".module_selected").remove(),$("#col-side-b .pos").prepend(r)}else $(".module_selected").remove()})},$.fn.facebookShare=function(){$(this).click(function(){var e=window.location.href;return window.open("http://www.facebook.com/sharer.php?u="+e,"shareFacebook","resizable=1,scrollbars=1,width=600,height=400"),!1})},$.fn.reformatDisclosure=function(){var e=$(this).children("section").find("img");if(e.length>0){var t=e.clone();$(this).find("h4").append(t),e.remove()}},$.fn.calculateMortgage=function(e){function r(){t.find("li").each(function(){key=o(this),value=s(this),n[key]=value})}function i(){r();var e=0;n.Rate>0&&(e=n.Rate/100);var i=n.Amount,s=n.Term,o=0,u=0,a=0,f=e/12,l=s*12,c=Math.pow(1+f,l),h=f*c/(c-1);isNaN(h)==1&&(h=1);var o=parseInt(n.Insurance)/12,u=parseInt(n.Tax)/12,p=(i-a)*h;p=Math.round(p*100)/100,o>0&&(p+=o),u>0&&(p+=u);var d=p+"";d.match(/[a-z]/g)!=null&&(p=0);var v=p*l,m=p;h==1&&(v=p,m=p/l);var g=v-(i-a)-n.Insurance*s-n.Tax*s;if(e<=0||s<=0)g=0,v=0;if(m>v||s<=0)m=0;var y=(new EJS({url:"/resources/jstemplates/mortgagecalculation"})).render({totalPaid:formatCurrency(v),interest:formatCurrency(g),monthlyPaid:formatCurrency(m)});$(".mortgage_calculation").remove(),t.find("section, .content").append(innerShiv(y))}function s(e){var t=$(e).find("input").val();t&&(t=t.replace(/,/g,""),t=parseFloat(t));if(t!=undefined)return t}function o(e){var t=$(e).find("label").text();t=t.replace(/:/,""),t=t.replace(/\sUSD/,""),t=t.replace(/\sYears/,""),t=t.replace(/\s\%/,""),t=t.replace(/USD/,""),t=t.replace(/Years/,""),t=t.replace(/\%/,""),keyA=t.split(" "),t=keyA[keyA.length-1];if(t!="")return t}var t=$(this),n={};return $.browser.msie&&$.browser.version>8&&t.find("sub").each(function(){var e=$(this).text();$(this).parent().parent().prepend('div class="sub">'+e+"</div>"),$(this).remove()}),t.find("input").unbind().keyup(function(){i()}),t.find("button").unbind().click(function(){return i(),!1}),i(),!1}
define(["backbonestore","underscore.string"],function(e,t){var n={};return n.User=e.Model.extend({defaults:{userId:null,ContactID:null,email:null,firstName:null,lastName:null,google:null,facebook:null,phone:null,postalCode:null,login_email:null,login_password:null,login_remember:null,photo:null,listingids:[],hiddenlistingids:[],savedlistings:[],savedlistingsCount:null,savedsearches:[],savedsearchesCount:null,ssqs:[],ssalerts:[],PreferredLocation:null},idAttribute:"userId",store:{key:"model-user-login",ttl:7200,server:!0},initialize:function(){this.on("change:email",this.updateEmailCookie),this.on("change:phone",this.updatePhoneCookie),this.on("change:firstName",this.updateFirstNameCookie),this.on("change:lastName",this.updateLastNameCookie),this.on("change:PreferredLocation",this.updatePrefLocationCookie)},updateEmailCookie:function(e,t){t&&$.cookie("lastEmail",t,{path:"/"})},updatePhoneCookie:function(e,t){t&&$.cookie("lastPhone",t,{path:"/"})},updateFirstNameCookie:function(e,t){t&&$.cookie("lastFirstName",t,{path:"/"})},updateLastNameCookie:function(e,t){t&&$.cookie("lastLastName",t,{path:"/"})},updateLocationCookie:function(e,t){t&&$.cookie("PreferredLocation",t,{path:"/"})},url:function(){},getUser:function(n){e.Store.get(this.store.key,function(e){n&&n(e)})},setAttribute:function(t,n){this.set(t,n),e.Store.saveState(this.store.key,this.attributes,7200)},isLoggedout:function(){var e=!0;return this.attributes.userId&&!isNaN(this.attributes.userId)&&(e=!1),e},setDefaults:function(){this.set(this.defaults)}}),n.LoginForm=e.Model.extend({name:"model-user-login",initialize:function(e){this.settings=e},url:function(){var e="/api/login/?",t=Array();return _.each(this.settings,function(e,n){t.push(n+"="+e)}),e+t.join("&")},reset:function(){var e=this;$.each(this.attributes,function(t,n){e.set(t,null)})}}),n.RegisterForm=e.Model.extend({name:"model-user-register",initialize:function(e){this.settings=e},url:function(){var e="/api/register/?",t=Array();return _.each(this.settings,function(e,n){t.push(n+"="+e)}),e+t.join("&")},reset:function(){var e=this;$.each(this.attributes,function(t,n){e.set(t,null)})}}),n.MoreSocialInfo=e.Model.extend({name:"model-user-moresocialinfo",initialize:function(e){this.settings=e},url:function(){var e="/api/forgotpassword/?",t=Array();return _.each(this.settings,function(e,n){t.push(n+"="+e)}),e+t.join("&")}}),n.ForgotPasswordForm=e.Model.extend({name:"model-user-forgotpassword",initialize:function(e){this.settings=e},url:function(){var e="/api/forgotpassword/?",t=Array();return _.each(this.settings,function(e,n){t.push(n+"="+e)}),e+t.join("&")}}),n.LogoutModel=e.Model.extend({name:"model-user-logout",initialize:function(e){this.settings=e},url:function(){var e="/api/logout/?",t=Array();return _.each(this.settings,function(e,n){t.push(n+"="+e)}),e+t.join("&")}}),n.SocialLogin=e.Model.extend({name:"model-social-login",initialize:function(e){this.settings=e,this.set("sociallogin",!0)},url:function(){var e="/api/login/?",t=Array();return _.each(this.settings,function(e,n){t.push(n+"="+e)}),e+t.join("&")}}),n.Users=e.Collection.extend({model:n.User,initialize:function(){}}),n.SavedListing=e.Model.extend({name:"model-savedlisting",initialize:function(e,t){this.attributes=e,this.settings=t,this.set("SavedListingTypeID",0)},url:function(){var e="/api/savedlisting/?",t=Array();return _.each(this.settings,function(e,n){t.push(n+"="+e)}),e+t.join("&")}}),n.SavedListings=e.Collection.extend({name:"collection-savedlistings",model:n.SavedListing,params:{Count:10,PageNumber:1,SiteID:siteid,PageCount:20},initialize:function(e,t){this.attributes=e,this.settings=t,this.setCode(),this.attributes.PageNumber||(this.attributes.PageNumber=this.params.PageNumber),HMSEvent.on("user-refresh-savedlistings",this.runQuery,this)},url:function(){var e="/api/savedlistings/?",t=Array();return _.each(this.settings,function(e,n){t.push(n+"="+e)}),e+t.join("&")},runQuery:function(){HMSEvent.trigger("ui-show-blocker",{element:"#js-profile-savedhomes"}),this.reset(),this.fetch({success:function(e,t){HMSEvent.trigger("onSavedListingsfetchComplete",t)}})},nextPage:function(){this.changePage(1)},previousPage:function(){this.changePage(-1)},changePage:function(t){this.setPage(parseInt(this.attributes.PageNumber,10)+t)},setPage:function(t){this.attributes.PageNumber=t,this.settings.PageNumber=t,this.runQuery()},removePaging:function(){return this.url(!0)},getTop:function(e){this.attributes.PageNumber=1,this.attributes.Count=e,this.runQuery()},sortBy:function(e){var t=!1;this.settings.PageCount=6,this.settings.PageNumber=1,e&&(e=="aws"&&(this.settings.sortby="ranking",this.settings.sortdesc=!0,t=!0),e=="lsv"&&(this.settings.sortby="savedon",this.settings.sortdesc=!0,t=!0),e=="fsv"&&(this.settings.sortby="savedon",this.settings.sortdesc=!1,t=!0),e=="phl"&&(this.settings.sortby="savedlistingprice",this.settings.sortdesc=!0,t=!0),e=="plh"&&(this.settings.sortby="savedlistingprice",this.settings.sortdesc=!1,t=!0),t&&(this.settings.code=e,$.cookie("slsortbycode",e,{path:"/"}),HMSUser.model.set("savedlistingsortby",this.settings.sortby),HMSUser.model.set("savedlistingsortdesc",this.settings.sortdesc),this.runQuery()))},setCode:function(){this.settings.sortby.toLowerCase()=="ranking"&&(this.settings.code="aws"),this.settings.sortby.toLowerCase()=="savedon"&&(this.settings.sortdesc?this.settings.code="lsv":this.settings.code="fsv"),this.settings.sortby.toLowerCase()=="savedlistingprice"&&(this.settings.sortdesc?this.settings.code="phl":this.settings.code="plh"),$.cookie("slsortbycode",this.settings.code,{path:"/"})},parse:function(e){e[0]&&(this.metadata=e[0])}}),n.HideListing=e.Model.extend({name:"model-hidelisting",initialize:function(e,t){this.attributes=e,this.settings=t,this.set("SavedListingTypeID",200)},url:function(){var e="/api/hidelisting/?",t=Array();return _.each(this.settings,function(e,n){t.push(n+"="+e)}),e+t.join("&")}}),n.HVHideListing=e.Model.extend({name:"model-hvhidelisting",initialize:function(e,t){this.attributes=e,this.settings=t,this.set("SavedListingTypeID",210)},url:function(){var e="/api/hidelisting/?",t=Array();return _.each(this.settings,function(e,n){t.push(n+"="+e)}),e+t.join("&")}}),n.ShareListing=e.Model.extend({name:"model-sharelisting",initialize:function(e,t){this.attributes=e,this.settings=t},url:function(){var e="/api/sharelisting/?",t=Array();return _.each(this.settings,function(e,n){t.push(n+"="+e)}),e+t.join("&")}}),n.HVShareListing=e.Model.extend({name:"model-hvsharelisting",initialize:function(e,t){this.attributes=e,this.settings=t,this.set("SharedListingTypeID",2)},url:function(){var e="/api/sharelisting/?",t=Array();return _.each(this.settings,function(e,n){t.push(n+"="+e)}),e+t.join("&")}}),n.HiddenListings=e.Model.extend({name:"model-hiddenlistings",initialize:function(e){this.settings=e,this.set("HiddenListings",!0)},url:function(){var e="/api/hiddenlistings/?",t=Array();return _.each(this.settings,function(e,n){t.push(n+"="+e)}),e+t.join("&")}}),n.HVHiddenListings=e.Model.extend({name:"model-hvhiddenlistings",initialize:function(e){this.settings=e,this.set("HVHiddenListings",!0)},url:function(){var e="/api/hiddenlistings/?",t=Array();return _.each(this.settings,function(e,n){t.push(n+"="+e)}),e+t.join("&")}}),n.UnhideListing=e.Model.extend({name:"model-unhidelisting",initialize:function(e,t){this.attributes=e,this.settings=t,this.set("action","unhidelisting")},url:function(){var e="/api/unhidelisting/?",t=Array();return _.each(this.settings,function(e,n){t.push(n+"="+e)}),e+t.join("&")}}),n.AddEditNotesModel=e.Model.extend({name:"model-addeditnotes",initialize:function(e,t){this.attributes=e,this.settings=t},url:function(){var e="/api/savedlisting/?",t=Array();return _.each(this.settings,function(e,n){t.push(n+"="+e)}),e+t.join("&")}}),n.SaveRanking=e.Model.extend({name:"model-saveranking",initialize:function(e,t){this.attributes=e,this.settings=t,this.set("action","saveranking")},url:function(){var e="/api/savedlisting/?",t=Array();return _.each(this.settings,function(e,n){t.push(n+"="+e)}),e+t.join("&")}}),n.SavedSearch=e.Model.extend({name:"model-savedsearch",initialize:function(e,t){this.attributes=e,this.settings=t},url:function(){var e="/api/savedsearch/?",t=Array();return _.each(this.settings,function(e,n){t.push(n+"="+e)}),e+t.join("&")}}),n.SavedSearches=e.Collection.extend({name:"collection-savedsearches",model:n.SavedSearch,params:{Count:10,PageNumber:1,SiteID:siteid,PageCount:20},initialize:function(e,t){this.attributes=e,this.settings=t,this.attributes.PageNumber||(this.attributes.PageNumber=this.params.PageNumber),HMSEvent.on("user-refresh-savedsearches",this.runQuery,this)},url:function(){var e="/api/savedsearches/?",t=Array();return _.each(this.settings,function(e,n){t.push(n+"="+e)}),e+t.join("&")},runQuery:function(){HMSEvent.trigger("ui-show-blocker",{element:"#js-profile-savedsearches"}),this.reset(),this.fetch({success:function(e,t){HMSEvent.trigger("onSavedSearchesfetchComplete",t)}})},nextPage:function(){this.changePage(1)},previousPage:function(){this.changePage(-1)},changePage:function(t){this.setPage(parseInt(this.attributes.PageNumber,10)+t)},setPage:function(t){this.attributes.PageNumber=t,this.settings.PageNumber=t,this.runQuery()},removePaging:function(){return this.url(!0)},getTop:function(e){this.attributes.PageNumber=1,this.attributes.Count=e,this.runQuery()},parse:function(e){e[0]&&(this.metadata=e[0])}}),n.AccountSettings=e.Model.extend({name:"model-acountsettings",initialize:function(e){this.settings=e},url:function(){var e="/api/profile/?",t=Array();return _.each(this.settings,function(e,n){t.push(n+"="+e)}),e+t.join("&")}}),n.ForeclosureAuth=e.Model.extend({name:"model-foreclosure-create-authenticate",initialize:function(e){this.settings=e},url:function(){var e="/api/rtauth/?",t=Array();return _.each(this.settings,function(e,n){t.push(n+"="+e)}),e+t.join("&")}}),n})